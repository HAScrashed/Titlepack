#Include "Libs/miltant/ObstacleV2/Components/UIBuilder/Menus.Script.txt"                as Menus
#Include "Libs/miltant/ObstacleV2/Components/UIBuilder/Windows.Script.txt"                as Windows

#Include "Libs/miltant/ObstacleV2/Components/MainMenu/CampaignMenu/Index.Script.txt"    as CampaignMenu
#Include "Libs/miltant/ObstacleV2/Components/MainMenu/TutorialsMenu/Index.Script.txt"   as TutorialsMenu
#Include "Libs/miltant/ObstacleV2/Components/MainMenu/OnlineMenu/Index.Script.txt"      as OnlineMenu
#Include "Libs/miltant/ObstacleV2/Components/MainMenu/MapsMenu/Index.Script.txt"        as MapsMenu
#Include "Libs/miltant/ObstacleV2/Components/MainMenu/EditorsMenu/Index.Script.txt"     as EditorsMenu
#Include "Libs/miltant/ObstacleV2/Components/MainMenu/CreditsMenu/Index.Script.txt"     as CreditsMenu


Void Load() {
    declare Menus::K_Section BackItem;
    BackItem.Name = "back_main";
    BackItem.DisplayName = "Back";
    BackItem.Icon = "";
    BackItem.Alias = "main_menu";
    Menus::CreateMenu(BackItem);


    declare CampaignItem = CampaignMenu::Load();
    CampaignItem.Menu.add("back_main");
    Menus::CreateMenu(CampaignItem);

    declare TutorialsItem = TutorialsMenu::Load();
    TutorialsItem.Menu.add("back_main");
    Menus::CreateMenu(TutorialsItem);

    declare OnlineItem = OnlineMenu::Load();
    OnlineItem.Menu.add("back_main");
    Menus::CreateMenu(OnlineItem);

    declare MapsItem = MapsMenu::Load();
    MapsItem.Menu.add("back_main");
    Menus::CreateMenu(MapsItem);

    declare Menus::K_Section ProfileItem;
    ProfileItem.Name = "profile";
    ProfileItem.DisplayName = "Profile";
    ProfileItem.Icon = "";
    Menus::CreateMenu(ProfileItem);

    declare EditorsItem = EditorsMenu::Load();
    EditorsItem.Menu.add("back_main");
    Menus::CreateMenu(EditorsItem);

    declare CreditsItem = CreditsMenu::Load();
    CreditsItem.Menu.add("back_main");
    Menus::CreateMenu(CreditsItem);


    declare Menus::K_Section QuitItem;
    QuitItem.Name = "quit";
    QuitItem.DisplayName = "Quit";
    QuitItem.Icon = "";
    Menus::CreateMenu(QuitItem);




    declare Menus::K_Section MainMenuSection;
    MainMenuSection.Name = "main_menu";
    MainMenuSection.DisplayName = "Main Menu";
    MainMenuSection.Icon = "";
    MainMenuSection.Menu = ["campaign", "tutorials", "online", "maps", "profile", "editors", "credits", "quit"];
    Menus::CreateMenu(MainMenuSection);

    Menus::Load("main_menu");
}


Void Loop() {
    CampaignMenu::Loop();
    TutorialsMenu::Loop();
    OnlineMenu::Loop();
    MapsMenu::Loop();
    EditorsMenu::Loop();
    CreditsMenu::Loop();

    Menus::Loop();
    Windows::Loop();

    
    foreach(Event in PendingEvents) {
        switch(Event.Type) {
            case CManiaAppEvent::EType::LayerCustomEvent: {
                switch(Event.CustomEventType) {
                    case "item_click" : {
                        if (Event.CustomEventData.count > 0) {
                            switch (Event.CustomEventData[0]) {
                                case "profile": {
                                    Menu_Profile();
                                }

                                case "quit": {
                                    Menu_Quit();
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}